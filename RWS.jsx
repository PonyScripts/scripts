
		if(!$["_extAutomationBlocks"]) {
			alert("Automation Blocks is not initialized. To run this script make sure the extension Automation Blocks is installed.");
			throw new Error("could not find Automation Blocks API");
		}
		
	(function(thisObj){
		$._extAutomationBlocks.all.abDestructor.announceEndPoint("main script");
		var myResult;
		try {
			app.beginUndoGroup("Automation Blocks");
			myResult = JSON.stringify({status:"SUCCESS", data: eval("var Variable_new_Name, VM_layer_var, Property_for_Expression, VM_slider_var;\n\nfunction esMathRandomInt(a, b) {\n  if (a > b) {\n    // Swap a and b to ensure a is smaller.\n    var c = a;\n    a = b;\n    b = c;\n  }\n  return Math.floor(Math.random() * (b - a + 1) + a);\n}\n\nfunction esMathRandomFloat(a, b) {\n  if (a > b) {\n    // Swap a and b to ensure a is smaller.\n    var c = a;\n    a = b;\n    b = c;\n  }\n  return (Math.random() * (b - a) + a);\n}\n\n\n$._extAutomationBlocks.all.messageAboutExecuteBlock('mBU}V!0Kbi,HPPB:3kS6');\nif (false) {\n}\n$._extAutomationBlocks.all.messageAboutExecuteBlock(');5O#^)B(EH6MNJl@D.y');\nif (!($._extAutomationBlocks.AeLayer.getLayers(($._extAutomationBlocks.AeComp.getActiveComp()), {onlySelected:true,sortSelection:false, typeArray: [\"Layer\"]})).length) {\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('iDb1M$N~=bhf0C{04NOt');\n  (function(){\n  \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('Select Layer');\n  \t\t\talert(message);\n\n  \t})();\n} else {\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('n^~:7HX/.~p/Ee9:q}]T');\n  Variable_new_Name = 'Rot|Wig ';\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('~@q|7W4d($4oAA?XuX;f');\n  var VM_layer_var_list = $._extAutomationBlocks.AeLayer.getLayers(($._extAutomationBlocks.AeComp.getActiveComp()), {recursively: false,onlySelected:true,sortSelection:false, typeArray: [\"Layer\"],returnItem:true});\n  for (var VM_layer_var_index =0; VM_layer_var_index< VM_layer_var_list.length;VM_layer_var_index++) {\n    try { VM_layer_var = $._extAutomationBlocks.AeUtility.toPath(VM_layer_var_list[VM_layer_var_index]);}\n  \t\tcatch(e) {\n  \t\t\t$._extAutomationBlocks.all.log(\"skipped loop iteration:\"+e.message);\n  \t\t\tcontinue;\n  \t\t}\n  \t\t  $._extAutomationBlocks.all.messageAboutExecuteBlock('F{weZ/*%POsSAHdL6P=+');\n    Property_for_Expression = ($._extAutomationBlocks.AeLayer.toLayer(VM_layer_var) + '/' + 'ADBE Transform Group/ADBE Rotate Z');\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('8O[,I(-3{)V1JVk((Q@z');\n    if (($._extAutomationBlocks.AeProperty.getAttribute(Property_for_Expression, 'EXPRESSION')) != '') {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('VcgV+[iyP7V?#}+-78A_');\n      (function(){\n      \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString((String($._extAutomationBlocks.AeLayer.getAttribute(VM_layer_var, 'NAME')) + ' --> Rotation has Expression!'));\n      \t\t\talert(message);\n\n      \t})();\n    } else {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('-IV7*Wsk5i5EVx)|Knx0');\n      VM_slider_var = $._extAutomationBlocks.AeLayer.addEffect(VM_layer_var,'ADBE Slider Control',{customValues: {'ADBE Slider Control-0001':2.5}});\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('tT5#ne4-cgn3Fm(2],O}');\n      $._extAutomationBlocks.AeProperty.setAttribute(VM_slider_var, 'NAME', (String(Variable_new_Name) + 'Amp'));\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('k/{MCzGCbuYI37lP,Jr2');\n      VM_slider_var = $._extAutomationBlocks.AeLayer.addEffect(VM_layer_var,'ADBE Slider Control',{customValues: {'ADBE Slider Control-0001':0.25}});\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('Q1cb^^5;;{CS--P|aY]_');\n      $._extAutomationBlocks.AeProperty.setAttribute(VM_slider_var, 'NAME', (String(Variable_new_Name) + 'Frq'));\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('b~Fg#mb/Jq5UR:GtT3P%');\n      VM_slider_var = $._extAutomationBlocks.AeLayer.addEffect(VM_layer_var,'ADBE Slider Control',{customValues: {'ADBE Slider Control-0001':(Math.floor(($._extAutomationBlocks.AeComp.getAttribute(($._extAutomationBlocks.AeComp.getActiveComp()), 'DURATION')) / 2))}});\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('8OqO?DuK-6-)tkjJH}r~');\n      $._extAutomationBlocks.AeProperty.setAttribute(VM_slider_var, 'NAME', (String(Variable_new_Name) + 'Loop Duration'));\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('hrbPdgxSC9U{I)M|.U~G');\n      VM_slider_var = $._extAutomationBlocks.AeLayer.addEffect(VM_layer_var,'ADBE Slider Control',{customValues: {'ADBE Slider Control-0001':100}});\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('vIs]%|E3Jl/HarYxt!Aa');\n      $._extAutomationBlocks.AeProperty.setAttribute(VM_slider_var, 'NAME', (String(Variable_new_Name) + 'Influence Power'));\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('iJaVJHBURrv6oL!4*E4p');\n      $._extAutomationBlocks.AeProperty.setAttribute((String(VM_slider_var) + '/ADBE Slider Control-0001'), 'EXPRESSION', 'clamp(value,0,100)');\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('E9|,=6bl^S*gM$*HfFXn');\n      $._extAutomationBlocks.AeProperty.setAttribute(Property_for_Expression, 'EXPRESSION', (['/*== Based on Duik: Wiggle ==*/ var freq = effect(\"Rot|Wig Frq\")(\"Slider\"); var amp = effect(\"Rot|Wig Amp\")(\"Slider\")*(effect(\"Rot|Wig Influence Power\")(\"Slider\")/100); var linked = false; var loop = effect(\"Rot|Wig Loop Duration\")(\"Slider\"); var complexity = 1; var multiplier = 0.5; var seed = ',esMathRandomInt(1, 999),'; var layerSeed = true;  function integrateLinearKeys( prop ) { if (typeof prop === \\'undefined\\') prop = thisProperty; var nK = prop.numKeys; if (nK < 2) return prop.value*(time - inPoint); if (prop.key(1).time > time ) return prop.value*(time - inPoint); var result = prop.key(1).value * (prop.key(1).time - inPoint); for (var i = 2; i <= nK; i++){ if ( prop.key(i).time > time ) break; var k1 = prop.key(i-1); var k2 = prop.key(i); result += (k1.value + k2.value) * (k2.time - k1.time)/2; } result += (prop.value + prop.key(i-1).value) * (time - prop.key(i-1).time) / 2; return result; }   var result = value; if (true) { if (layerSeed) seed += index; seedRandom(seed); var doLoop = freq.numKeys < 2; if (loop == 0) loop = thisComp.duration; var t = time; var f = 1; if (doLoop) {     t = (time % loop)-loop;     f = freq.value; } else {     t = integrateLinearKeys( freq ); } var w1 = wiggle(f, amp, complexity, multiplier, t); var w2 = wiggle(f, amp, complexity, multiplier, t - loop); var w = w1; if (doLoop) w = ease(t, -loop,  0, w1, w2); result = []; if(linked) while (result.length < value.length) result.push(w[0]); else result = w; result += value - valueAtTime(0); } result;'].join('')));\n    }\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('~@q|7W4d($4oAA?XuX;f');\n  }\n}\n")});
		}
		catch(err){
			myResult = JSON.stringify({status:"ERROR", data:""+err.message+" (line "+(err.line)+")"});
		}
		finally {
			app.endUndoGroup();
			try{
			$._extAutomationBlocks.all.abDestructor.notifyEndPointReached("main script");
			}
			catch(err){
				myResult = JSON.stringify({status:"ERROR", data:""+err.message+" (line "+(err.line)+")"});
			}
		}
		return myResult;
	})(this)
	