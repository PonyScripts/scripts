
		if(!$["_extAutomationBlocks"]) {
			alert("Automation Blocks is not initialized. To run this script make sure the extension Automation Blocks is installed.");
			throw new Error("could not find Automation Blocks API");
		}
		
	(function(thisObj){
		$._extAutomationBlocks.all.abDestructor.announceEndPoint("main script");
		var myResult;
		try {
			app.beginUndoGroup("Automation Blocks");
			myResult = JSON.stringify({status:"SUCCESS", data: eval("var L, Layer_inOut, Audio_list, Effect, my_effect, Keyframes, j, temp_effect_name, i;\n\n\n$._extAutomationBlocks.all.messageAboutExecuteBlock('/Z{y_J$)P0`[T:2{%bWK');\nif (($._extAutomationBlocks.AeLayer.getLayers(($._extAutomationBlocks.AeComp.getActiveComp()), {onlySelected:true,sortSelection:false, typeArray: [\"Layer\"]})).length == 1) {\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('sTS,4uKVY;cpx3NZP@~`');\n  if ($._extAutomationBlocks.AeProjectItem.exists(('/_VM_temp_'))) {\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('}lxI,xN}xQG7kc~/)n8+');\n    L = ($._extAutomationBlocks.AeLayer.getOnlySelectedLayer(($._extAutomationBlocks.AeComp.getActiveComp())));\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('#8*)d{Z~ra}`^o;psHtq');\n    Layer_inOut = [$._extAutomationBlocks.AeLayer.getAttribute(L, 'IN_POINT'), $._extAutomationBlocks.AeLayer.getAttribute(L, 'OUT_POINT')];\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('q.9w|@AnHZV^*0+}e%bV');\n    Audio_list = ($._extAutomationBlocks.AeProperty.getAttribute(('/_VM_temp_::_saved_data_/ADBE Text Properties/ADBE Text Document'), 'VALUE')).split('#@#');\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('aqM:Bbv/1w3oc.X+.u=S');\n    Effect = 0;\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('sbDP?CI]@i1p1*CKaU`K');\n    var my_effect_list = $._extAutomationBlocks.AeProperty.getEffects(L, {direction:\"BACKWARD\",resultType:\"ITEM\"});\n    for (var my_effect_index =0; my_effect_index< my_effect_list.length;my_effect_index++) {\n      try { my_effect = $._extAutomationBlocks.AeUtility.toPath(my_effect_list[my_effect_index]);}\n    \t\tcatch(e) {\n    \t\t\t$._extAutomationBlocks.all.log(\"skipped loop iteration:\"+e.message);\n    \t\t\tcontinue;\n    \t\t}\n    \t\t  $._extAutomationBlocks.all.messageAboutExecuteBlock('w6w`o9WyU-4p`R}0K/pM');\n      if (($._extAutomationBlocks.AeProperty.getAttribute(my_effect, 'NAME')) == 'Mouth Index') {\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('die0HsK5^135=1KNjqT8');\n        Effect = String(my_effect) + '/ADBE Slider Control-0001';\n      }\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('sbDP?CI]@i1p1*CKaU`K');\n    }\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('Y2]N!YKg^fHV0qx3rX-6');\n    Keyframes = [];\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('^+30M|VjrQb7%0Kay?ju');\n    if (Effect != 0) {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('hgt))l3EAv}}W-z`,H{;');\n      for (var j_index =0; j_index< Audio_list.length;j_index++) {\n        try { j = Audio_list[j_index];}\n      \t\tcatch(e) {\n      \t\t\t$._extAutomationBlocks.all.log(\"skipped loop iteration:\"+e.message);\n      \t\t\tcontinue;\n      \t\t}\n      \t\t  $._extAutomationBlocks.all.messageAboutExecuteBlock('5?~U$YBjV%O~H(DRyi.c');\n        $._extAutomationBlocks.AeLayer.setAttribute(L, 'IN_POINT', ($._extAutomationBlocks.AeLayer.getAttribute(j, 'IN_POINT')));\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('(G(|Xt]l}KDMAEM!4={f');\n        $._extAutomationBlocks.AeLayer.setAttribute(L, 'OUT_POINT', ($._extAutomationBlocks.AeLayer.getAttribute(j, 'OUT_POINT')));\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('f6iHYW*:cn]YRu]tzPup');\n        $._extAutomationBlocks.AeProperty.setAttribute(Effect, 'SELECTED', (true));\n        $._extAutomationBlocks.all.messageAboutExecuteBlock(':B0HlKE)/=Rjo:%lw$7B');\n        $._extAutomationBlocks.AeApp.executeMenuCommand('Convert Expression to Keyframes');\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('11]p*?;N95HW78#Blv3g');\n        $._extAutomationBlocks.AeApp.executeMenuCommand('Toggle Hold Keyframe');\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('l;ICWr-K^Lfy_c~,tk*g');\n        Keyframes.push(($._extAutomationBlocks.AeProperty.readKeyframeJson(Effect,{type: \"SELECTED\"})));\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('oOam1h7Sn?#3,w8Ku@ZS');\n        $._extAutomationBlocks.AeProperty.setAttribute(Effect, 'EXPRESSION_ENABLED', (true));\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('hgt))l3EAv}}W-z`,H{;');\n      }\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('+){GoGr(z+jPd#RA0/6}');\n      $._extAutomationBlocks.AeProperty.setAttribute(Effect, 'EXPRESSION_ENABLED', (false));\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('t[)j]Vl%0]n!%54(nK++');\n      var my_effect_list2 = $._extAutomationBlocks.AeProperty.getEffects(L, {direction:\"BACKWARD\",resultType:\"ITEM\"});\n      for (var my_effect_index2 =0; my_effect_index2< my_effect_list2.length;my_effect_index2++) {\n        try { my_effect = $._extAutomationBlocks.AeUtility.toPath(my_effect_list2[my_effect_index2]);}\n      \t\tcatch(e) {\n      \t\t\t$._extAutomationBlocks.all.log(\"skipped loop iteration:\"+e.message);\n      \t\t\tcontinue;\n      \t\t}\n      \t\t  $._extAutomationBlocks.all.messageAboutExecuteBlock('qPKh!Mj|{oG/gT)-0H~@');\n        temp_effect_name = ($._extAutomationBlocks.AeProperty.getAttribute(my_effect, 'NAME'));\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('(y(kQ!1bL6zfw)gPVh{t');\n        if (temp_effect_name == 'Process audio stage Two' || (temp_effect_name == 'Process audio stage One' || temp_effect_name == 'Audio Manager')) {\n          $._extAutomationBlocks.all.messageAboutExecuteBlock('}#a,F1EUD0a~@|Sbb*lH');\n          $._extAutomationBlocks.AeProperty.setAttribute((String(my_effect) + '/ADBE Slider Control-0001'), 'EXPRESSION_ENABLED', (false));\n        }\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('t[)j]Vl%0]n!%54(nK++');\n      }\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('iitC2(D%Hzwu}_G1!ts=');\n      $._extAutomationBlocks.AeLayer.setAttribute(L, 'IN_POINT', (Layer_inOut[0]));\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('`9=jLYxW%SiY!}LF]sJC');\n      $._extAutomationBlocks.AeLayer.setAttribute(L, 'OUT_POINT', (Layer_inOut.slice(-1)[0]));\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('S!:@pT_M%^dl~-,D)Zl2');\n      if (Audio_list.length > 1) {\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('~hy(o!xs~e:]Py#N7%zv');\n        $._extAutomationBlocks.AeProperty.deleteKeyframes(Effect, {\n        \t\ttimeMin: (Layer_inOut[0]),\n        \t\ttimeMax: (Layer_inOut.slice(-1)[0]),\n        \t\tincludeMin: true,\n        \t\tincludeMax: true\n        \t});\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('SKq[kMAt(-hyyU(~$}l,');\n        var i_end = Audio_list.length;\n        var i_inc = 1;\n        if (1 > i_end) {\n          i_inc = -i_inc;\n        }\n        for (i = 1; i_inc >= 0 ? i <= i_end : i >= i_end; i += i_inc) {\n          $._extAutomationBlocks.all.messageAboutExecuteBlock('a;Zp@FxZwdV$Zd^lqp9|');\n          $._extAutomationBlocks.AeProperty.applyKeyframeJson((Keyframes[(i - 1)]),Effect, {\n          \t\tmergeStrategy: [('none'),('none')],\n          \t\tstartTime: ($._extAutomationBlocks.AeLayer.getAttribute((Audio_list[(i - 1)]), 'IN_POINT'))\n          \t});\n          $._extAutomationBlocks.all.messageAboutExecuteBlock('SKq[kMAt(-hyyU(~$}l,');\n        }\n      }\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('Lq?L11/([i2Gvhs/(qH6');\n      $._extAutomationBlocks.AeProject.deleteProjectItems(('/_VM_temp_'));\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('STyA2bCxbQWBUCOszTmr');\n      (function(){\n      \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('Done');\n      \t\t\talert(message);\n\n      \t})();\n    } else {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('!tUH)gBb?_Yo~H6|I9@Z');\n      (function(){\n      \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('Effect \" Mouth Index \" not found');\n      \t\t\talert(message);\n      \t\t\tthrow new Error(message)\n      \t})();\n    }\n  } else {\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('f,}h!WyqRFiULS/{_qXH');\n    (function(){\n    \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('No stored Audio Layers');\n    \t\t\talert(message);\n    \t\t\tthrow new Error(message)\n    \t})();\n  }\n} else {\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('11qro69.!|)fGIu7Gg7n');\n  (function(){\n  \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('Select One Layer');\n  \t\t\talert(message);\n  \t\t\tthrow new Error(message)\n  \t})();\n}\n")});
		}
		catch(err){
			myResult = JSON.stringify({status:"ERROR", data:""+err.message+" (line "+(err.line)+")"});
		}
		finally {
			app.endUndoGroup();
			try{
			$._extAutomationBlocks.all.abDestructor.notifyEndPointReached("main script");
			}
			catch(err){
				myResult = JSON.stringify({status:"ERROR", data:""+err.message+" (line "+(err.line)+")"});
			}
		}
		return myResult;
	})(this)
	