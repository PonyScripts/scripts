
		if(!$["_extAutomationBlocks"]) {
			alert("Automation Blocks is not initialized. To run this script make sure the extension Automation Blocks is installed.");
			throw new Error("could not find Automation Blocks API");
		}
		
	(function(thisObj){
		$._extAutomationBlocks.all.abDestructor.announceEndPoint("main script");
		var myResult;
		try {
			app.beginUndoGroup("Automation Blocks");
			myResult = JSON.stringify({status:"SUCCESS", data: eval("var Data_list, trg_Found, my_effect, trg_effect, Expr, index, Data, Name, Comp, link;\n\n\n$._extAutomationBlocks.all.messageAboutExecuteBlock('BV*eIqOMMe`8NR@0X}[3');\nif ($._extAutomationBlocks.AeProjectItem.exists(('/_VM_temp_'))) {\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('4ig;AK=(2E1;`D9RxJOi');\n  if (($._extAutomationBlocks.AeLayer.getLayers(($._extAutomationBlocks.AeComp.getActiveComp()), {onlySelected:true,sortSelection:false, typeArray: [\"Layer\"]})).length == 1) {\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('6XK9vm+Kp1[TArJ`-9z)');\n    Data_list = ($._extAutomationBlocks.AeProperty.getAttribute(($._extAutomationBlocks.AeLayer.toLayer(('/_VM_temp_::_saved_data_')) + '/' + 'ADBE Text Properties/ADBE Text Document'), 'VALUE')).split('#@#');\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('di~~%BHYh5wz%v6;xF[x');\n    trg_Found = false;\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('3rr1KH+z_=ybQ$nS2/;p');\n    var my_effect_list = $._extAutomationBlocks.AeProperty.getEffects(($._extAutomationBlocks.AeLayer.getOnlySelectedLayer(($._extAutomationBlocks.AeComp.getActiveComp()))), {direction:\"BACKWARD\",resultType:\"ITEM\"});\n    for (var my_effect_index =0; my_effect_index< my_effect_list.length;my_effect_index++) {\n      try { my_effect = $._extAutomationBlocks.AeUtility.toPath(my_effect_list[my_effect_index]);}\n    \t\tcatch(e) {\n    \t\t\t$._extAutomationBlocks.all.log(\"skipped loop iteration:\"+e.message);\n    \t\t\tcontinue;\n    \t\t}\n    \t\t  $._extAutomationBlocks.all.messageAboutExecuteBlock('9=7Lbuy8A/a)_Z[^~+qv');\n      if (($._extAutomationBlocks.AeProperty.getAttribute(my_effect, 'NAME')) == 'Audio Manager') {\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('-LaN0c~iK+VZEF?v^C!E');\n        trg_effect = String(my_effect) + '/ADBE Slider Control-0001';\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('RRljR#?sdYmT0ILI2XkZ');\n        trg_Found = true;\n      }\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('3rr1KH+z_=ybQ$nS2/;p');\n    }\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('xO@nuPCOqvNXwLW!6uNb');\n    if (trg_Found) {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('_Aw?Z_UhoVcy]U62?FIn');\n      Expr = ($._extAutomationBlocks.AeProperty.getAttribute(trg_effect, 'EXPRESSION'));\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('L9JKyb;f)2TuZ,T`zuF=');\n      index = Expr.slice(0, (Expr.lastIndexOf('//#') + 1) - 1).split('' + '\\n' +\n      '').length - 2;\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('McQc:9#+|InUMq4Q_IRp');\n      for (var Data_index =0; Data_index< Data_list.length;Data_index++) {\n        try { Data = Data_list[Data_index];}\n      \t\tcatch(e) {\n      \t\t\t$._extAutomationBlocks.all.log(\"skipped loop iteration:\"+e.message);\n      \t\t\tcontinue;\n      \t\t}\n      \t\t  $._extAutomationBlocks.all.messageAboutExecuteBlock('(-~4^?^jy3@$mPrtD=wF');\n        index = (typeof index == 'number' ? index : 0) + 1;\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('A4!]VoU22uR{6(D_TM0]');\n        Name = Data.slice(((Data.lastIndexOf('::') + 1 + 2) - 1), Data.length);\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('P]VPg3H0cgs2k[:P[sef');\n        Comp = Data.slice(((Data.lastIndexOf('/') + 1 + 1) - 1), (Data.lastIndexOf('::') + 1) - 1);\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('vuL@3o}nl)kTjA9~#UQj');\n        link = ['_VM_s',index,' = ','comp(\"',Comp,'\").layer(\"',Name,'\").effect(\"Audio Amplitude\")(\"Slider\")'].join('');\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('0V,gdiG#GbZhE1P4.aco');\n        $._extAutomationBlocks.AeProperty.setAttribute(trg_effect, 'EXPRESSION', ($._extAutomationBlocks.all.EsString.stringReplace(($._extAutomationBlocks.all.EsString.stringReplace(($._extAutomationBlocks.AeProperty.getAttribute(trg_effect, 'EXPRESSION')),'//#',(String(link) + String('' + '\\n' +\n        '//#')),'REPLACE_FIRST',(false),(false))),'//@',([' + _VM_s',index,'//@'].join('')),'REPLACE_FIRST',(false),(false))));\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('McQc:9#+|InUMq4Q_IRp');\n      }\n    } else {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('o#N9Vadkpr15-6C6h`^V');\n      (function(){\n      \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('Effect \" Audio Manager \" not found');\n      \t\t\talert(message);\n      \t\t\tthrow new Error(message)\n      \t})();\n    }\n  } else {\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('Xs8j,B%~E@fLxb[vT`2g');\n    (function(){\n    \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('Select target layer');\n    \t\t\talert(message);\n    \t\t\tthrow new Error(message)\n    \t})();\n  }\n} else {\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('=tPlT$~gTwq8v-Z$ov)P');\n  (function(){\n  \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('No stored Audio Layers');\n  \t\t\talert(message);\n  \t\t\tthrow new Error(message)\n  \t})();\n}\n$._extAutomationBlocks.all.messageAboutExecuteBlock('ga7St(40%5SM,mz2QCqR');\n(function(){\n\t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('Done');\n\t\t\talert(message);\n\n\t})();\n\n$._extAutomationBlocks.all.messageAboutExecuteBlock('i=4m7C3661vV}27{6`*H');\n0;\n")});
		}
		catch(err){
			myResult = JSON.stringify({status:"ERROR", data:""+err.message+" (line "+(err.line)+")"});
		}
		finally {
			app.endUndoGroup();
			try{
			$._extAutomationBlocks.all.abDestructor.notifyEndPointReached("main script");
			}
			catch(err){
				myResult = JSON.stringify({status:"ERROR", data:""+err.message+" (line "+(err.line)+")"});
			}
		}
		return myResult;
	})(this)
	