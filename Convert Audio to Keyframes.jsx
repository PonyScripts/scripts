
		if(!$["_extAutomationBlocks"]) {
			alert("Automation Blocks is not initialized. To run this script make sure the extension Automation Blocks is installed.");
			throw new Error("could not find Automation Blocks API");
		}
		
	(function(thisObj){
		$._extAutomationBlocks.all.abDestructor.announceEndPoint("main script");
		var myResult;
		try {
			app.beginUndoGroup("Automation Blocks");
			myResult = JSON.stringify({status:"SUCCESS", data: eval("var Selected_layers, AllOk, j, Origin_workArea, VM_audioL, Temp_inp, temp_outP, i, VM_Audio_Amplitude, my_effect, my_variable, VM_keys;\n\n\n$._extAutomationBlocks.all.messageAboutExecuteBlock('F5h$~uK3h1_++s$V]nGa');\nSelected_layers = ($._extAutomationBlocks.AeLayer.getLayers(($._extAutomationBlocks.AeComp.getActiveComp()), {onlySelected:true,sortSelection:true, typeArray: [\"Layer\"]}));\n$._extAutomationBlocks.all.messageAboutExecuteBlock('Cxs,dlxfv0rE]yIRsdzB');\nAllOk = 0;\n$._extAutomationBlocks.all.messageAboutExecuteBlock('R2`D:r{x]ql*.lN~@DG+');\nfor (var j_index =0; j_index< Selected_layers.length;j_index++) {\n  try { j = Selected_layers[j_index];}\n\t\tcatch(e) {\n\t\t\t$._extAutomationBlocks.all.log(\"skipped loop iteration:\"+e.message);\n\t\t\tcontinue;\n\t\t}\n\t\t  $._extAutomationBlocks.all.messageAboutExecuteBlock('8%hrg{rU;0Rc.qXY=A)-');\n  if ($._extAutomationBlocks.AeLayer.getAttribute(j, 'HAS_AUDIO')) {\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('ckB%KWb.La2RHN`*dG~+');\n    AllOk = (typeof AllOk == 'number' ? AllOk : 0) + 1;\n  } else {\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('8Y3bD:TVX+WuJ~kmNUGT');\n    (function(){\n    \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString((['Layer \" ',$._extAutomationBlocks.AeLayer.getAttribute(j, 'NAME'),' \" without Audio'].join('')));\n    \t\t\talert(message);\n    \t\t\tthrow new Error(message)\n    \t})();\n  }\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('R2`D:r{x]ql*.lN~@DG+');\n}\n$._extAutomationBlocks.all.messageAboutExecuteBlock('*XGpjf~7nHgC#@;(MoO6');\n$._extAutomationBlocks.AeLayer.setAttribute(Selected_layers, 'AUDIO_ENABLED', (false));\n$._extAutomationBlocks.all.messageAboutExecuteBlock('`x8;I=WB;~M.Qv^Vb=jC');\nif (Selected_layers.length == AllOk) {\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('!}kl._lMMib6Qwz%tCBg');\n  Origin_workArea = [$._extAutomationBlocks.AeComp.getAttribute(($._extAutomationBlocks.AeComp.getActiveComp()), 'WORK_AREA_START'), $._extAutomationBlocks.AeComp.getAttribute(($._extAutomationBlocks.AeComp.getActiveComp()), 'WORK_AREA_END')];\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('8$]pR[VG~)K:Whpc*rER');\n  for (var VM_audioL_index =0; VM_audioL_index< Selected_layers.length;VM_audioL_index++) {\n    try { VM_audioL = Selected_layers[VM_audioL_index];}\n  \t\tcatch(e) {\n  \t\t\t$._extAutomationBlocks.all.log(\"skipped loop iteration:\"+e.message);\n  \t\t\tcontinue;\n  \t\t}\n  \t\t  $._extAutomationBlocks.all.messageAboutExecuteBlock('9Q-SB~;UkSp~P1VZdhU;');\n    Temp_inp = ($._extAutomationBlocks.AeLayer.getAttribute(VM_audioL, 'IN_POINT'));\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('tt*}y9xi8`?iBH-T`WAA');\n    temp_outP = ($._extAutomationBlocks.AeLayer.getAttribute(VM_audioL, 'OUT_POINT'));\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('39tZA?5pOum*G[tDHrQW');\n    for (i = 1; i <= 5; i++) {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('OV;qvWjBmN;];e~+Ds[~');\n      if (($._extAutomationBlocks.AeComp.getAttribute(($._extAutomationBlocks.AeComp.getActiveComp()), 'WORK_AREA_START')) == Temp_inp) {\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('cX#qS5zm8@;5{r]=:iC.');\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('39tZA?5pOum*G[tDHrQW');\n        break;\n      }\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('izgjEZg2%lra#}5wQ;Mc');\n      $._extAutomationBlocks.AeComp.setAttribute(($._extAutomationBlocks.AeComp.getActiveComp()), 'WORK_AREA_START', Temp_inp);\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('39tZA?5pOum*G[tDHrQW');\n    }\n    $._extAutomationBlocks.all.messageAboutExecuteBlock(')V1+XGk?vu#`8{+#KAN@');\n    for (i = 1; i <= 5; i++) {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('[ohWo;E/!6^VKr8A-!Y8');\n      if (($._extAutomationBlocks.AeComp.getAttribute(($._extAutomationBlocks.AeComp.getActiveComp()), 'WORK_AREA_END')) == temp_outP) {\n        $._extAutomationBlocks.all.messageAboutExecuteBlock('cg1Xx0#7vg(j!/m93Na+');\n        $._extAutomationBlocks.all.messageAboutExecuteBlock(')V1+XGk?vu#`8{+#KAN@');\n        break;\n      }\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('`5PVm9g.Nue;ktD.~!B2');\n      $._extAutomationBlocks.AeComp.setAttribute(($._extAutomationBlocks.AeComp.getActiveComp()), 'WORK_AREA_END', temp_outP);\n      $._extAutomationBlocks.all.messageAboutExecuteBlock(')V1+XGk?vu#`8{+#KAN@');\n    }\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('aC)];jV}*1pLwyv=:WN`');\n    $._extAutomationBlocks.AeLayer.setAttribute(VM_audioL, 'AUDIO_ENABLED', (true));\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('*y116bSja^-{|oH^WY?a');\n    $._extAutomationBlocks.AeApp.executeMenuCommand('Convert Audio to Keyframes');\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('F5T1[dj!z~*t2NaIxop(');\n    $._extAutomationBlocks.AeLayer.setAttribute(VM_audioL, 'AUDIO_ENABLED', (false));\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('O#*-e%^Nv}2a..JA:c^=');\n    VM_Audio_Amplitude = ($._extAutomationBlocks.AeLayer.getLayers(($._extAutomationBlocks.AeComp.getActiveComp()), {onlySelected:false,sortSelection:false, typeArray: [\"NullLayer\"]})).shift();\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('jt;Qo%3ozz`aJZ#*(dm@');\n    if (($._extAutomationBlocks.AeLayer.getAttribute(VM_Audio_Amplitude, 'NAME')) == 'Audio Amplitude') {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock(']rWn-AQz2M0FL`j=)=O_');\n      var my_effect_list = $._extAutomationBlocks.AeProperty.getEffects(($._extAutomationBlocks.AeComp.getActiveComp()), {direction:\"BACKWARD\",resultType:\"ITEM\"});\n      for (var my_effect_index =0; my_effect_index< my_effect_list.length;my_effect_index++) {\n        try { my_effect = $._extAutomationBlocks.AeUtility.toPath(my_effect_list[my_effect_index]);}\n      \t\tcatch(e) {\n      \t\t\t$._extAutomationBlocks.all.log(\"skipped loop iteration:\"+e.message);\n      \t\t\tcontinue;\n      \t\t}\n      \t\t  $._extAutomationBlocks.all.messageAboutExecuteBlock('2]A_Q938~PCNAHrb8{1(');\n        if (($._extAutomationBlocks.AeProperty.getAttribute(my_effect, 'NAME')) == 'Both Channels') {\n          $._extAutomationBlocks.all.messageAboutExecuteBlock('Zt,?P3%-tyyQ[1L:+:JW');\n          VM_keys = ($._extAutomationBlocks.AeProperty.readKeyframeJson(($._extAutomationBlocks.AeLayer.toLayer(VM_Audio_Amplitude) + '/' + 'ADBE Effect Parade/ADBE Slider Control/ADBE Slider Control-0001'),{type: \"ALL\"}));\n          $._extAutomationBlocks.all.messageAboutExecuteBlock('lh#U?(6/q1hO]+r$nK2y');\n          $._extAutomationBlocks.AeLayer.remove(VM_Audio_Amplitude);\n          $._extAutomationBlocks.all.messageAboutExecuteBlock('JNMKB$JQ~.Tr~7x7ya4|');\n          $._extAutomationBlocks.all.messageAboutExecuteBlock('8$]pR[VG~)K:Whpc*rER');\n          break;\n        }\n        $._extAutomationBlocks.all.messageAboutExecuteBlock(']rWn-AQz2M0FL`j=)=O_');\n      }\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('7W]I0E~(WR0)R|1sh;Aq');\n      my_variable = $._extAutomationBlocks.AeLayer.addEffect(VM_audioL,'ADBE Slider Control',{customValues: {'ADBE Slider Control-0001':0}});\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('nOhy$EXdbcKatS7hl.yJ');\n      $._extAutomationBlocks.AeProperty.applyKeyframeJson(VM_keys,($._extAutomationBlocks.AeLayer.toLayer(VM_audioL) + '/' + 'ADBE Effect Parade/ADBE Slider Control/ADBE Slider Control-0001'), {\n      \t\tmergeStrategy: [('none'),('none')],\n      \t\tstartTime: ($._extAutomationBlocks.AeLayer.getAttribute(VM_audioL, 'IN_POINT'))\n      \t});\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('y8JIgr7$q+Bakr2/=^KB');\n      $._extAutomationBlocks.AeProperty.setAttribute(my_variable, 'NAME', 'Audio Amplitude');\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('`PiT9HqT/bE;|q4rhu/t');\n      $._extAutomationBlocks.AeProject.deleteProjectItems(('/Solids/Audio Amplitude'));\n    } else {\n      $._extAutomationBlocks.all.messageAboutExecuteBlock('C(=b@]@)[i86Fi%8iTJI');\n      (function(){\n      \t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('No Audio Amplitude Layer');\n      \t\t\talert(message);\n      \t\t\tthrow new Error(message)\n      \t})();\n    }\n    $._extAutomationBlocks.all.messageAboutExecuteBlock('8$]pR[VG~)K:Whpc*rER');\n  }\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('=t4F9*#gpL31WW(-(=X(');\n  $._extAutomationBlocks.AeComp.setAttribute(($._extAutomationBlocks.AeComp.getActiveComp()), 'WORK_AREA_START', (Origin_workArea.shift()));\n  $._extAutomationBlocks.all.messageAboutExecuteBlock('!0[o_,Jj9QkT]CQN6a.u');\n  $._extAutomationBlocks.AeComp.setAttribute(($._extAutomationBlocks.AeComp.getActiveComp()), 'WORK_AREA_END', (Origin_workArea[0]));\n}\n$._extAutomationBlocks.all.messageAboutExecuteBlock('Bn/Te*~^%vD,AKxObo}W');\n$._extAutomationBlocks.AeLayer.setAttribute(Selected_layers, 'AUDIO_ENABLED', (true));\n$._extAutomationBlocks.all.messageAboutExecuteBlock('5KAGeeEa.q]hB.uGnAeH');\n(function(){\n\t\t\tvar message = $._extAutomationBlocks.all.EsString.esToString('Done');\n\t\t\talert(message);\n\n\t})();\n")});
		}
		catch(err){
			myResult = JSON.stringify({status:"ERROR", data:""+err.message+" (line "+(err.line)+")"});
		}
		finally {
			app.endUndoGroup();
			try{
			$._extAutomationBlocks.all.abDestructor.notifyEndPointReached("main script");
			}
			catch(err){
				myResult = JSON.stringify({status:"ERROR", data:""+err.message+" (line "+(err.line)+")"});
			}
		}
		return myResult;
	})(this)
	